<!DOCTYPE html>
<html>
closure 
<script>
    // 定时器需求，如果变量定义在函数内则无法实现，参数在每次函数调用时都被初始化
    let i = 0
    function doCounter(){
        const counter = setInterval(function(){
            console.log('i++')
            i++
            if(i === 10){
                console.log('timer stop')
                clearInterval(counter) 
            }
        },50)
    }


    // 当内部函数访问外部函数的变量，若内部函数始终存在于内存中，由于内部函数变量依赖于外部函数的原因，就会使得外部函数的数据不会被垃圾回收机制回收。
    function startCounter(){
        let n = 0

        function counter(){
            console.log('n++')
            n++
            if(n === 10){
                console.log('time up')
                clearInterval(timer)
                
                n = null //由于闭包会使得函数中的变量都被保存在内存中，这可能导致内存泄露。解决方法是，在退出函数之前，将不使用的局部变量全部删除。
            }
        }
        let timer = setInterval(function(){
            counter()
        },50)

    }
    console.log('i',i) // i可以被其他语句修改
    // console.log('n',n) // 而n只能在startCounter()函数中被访问到

</script>
</html>